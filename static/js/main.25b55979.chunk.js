(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{135:function(e,t,r){e.exports=r(246)},140:function(e,t,r){},245:function(e,t,r){},246:function(e,t,r){"use strict";r.r(t);var n,a,o,i,l,s,c,u,h,d,p,f,m,v,g=r(3),b=r(1),y=r.n(b),w=r(8),x=r.n(w),S=(r(140),r(28)),O=r(22),E=r.n(O),j=r(43),k=r(36),C=r(17),P=r(18),D=r(19),N=r(10),M=(r(65),n=g.b.bound,a=function(){function e(t){Object(P.a)(this,e),this.parent=t,Object(C.a)(this,"selectedNodes",o,this)}return Object(D.a)(e,[{key:"setSelectedNodes",value:function(e){this.selectedNodes=e}},{key:"pattern",get:function(){return null===this.parent.patternStore.selectedPatternId?null:this.parent.patternStore.subgraphs[this.parent.patternStore.selectedPatternId]}},{key:"hits",get:function(){return null===this.parent.patternStore.selectedPatternId?0:this.parent.patternStore.searchedSubgraphs.length}},{key:"hitNodes",get:function(){var e=new Set(this.selectedNodes.map(function(e){return e.label}));return new Set(this.parent.graphData.nodes.filter(function(t){return e.has(t.label)}).map(function(e){return e.index}))}},{key:"hitNodeLabels",get:function(){return new Set(this.selectedNodes.map(function(e){return e.label}))}}]),e}(),o=Object(N.a)(a.prototype,"selectedNodes",[g.j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Object(N.a)(a.prototype,"setSelectedNodes",[n],Object.getOwnPropertyDescriptor(a.prototype,"setSelectedNodes"),a.prototype),Object(N.a)(a.prototype,"pattern",[g.c],Object.getOwnPropertyDescriptor(a.prototype,"pattern"),a.prototype),Object(N.a)(a.prototype,"hits",[g.c],Object.getOwnPropertyDescriptor(a.prototype,"hits"),a.prototype),Object(N.a)(a.prototype,"hitNodes",[g.c],Object.getOwnPropertyDescriptor(a.prototype,"hitNodes"),a.prototype),Object(N.a)(a.prototype,"hitNodeLabels",[g.c],Object.getOwnPropertyDescriptor(a.prototype,"hitNodeLabels"),a.prototype),a),z=(i=g.b.bound,l=g.b.bound,s=g.b.bound,c=g.b.bound,u=g.b.bound,h=function(){function e(t){Object(P.a)(this,e),this.parent=t,Object(C.a)(this,"showContour",d,this),Object(C.a)(this,"showDiagram",p,this),Object(C.a)(this,"showDiagramEdge",f,this),Object(C.a)(this,"filterOutMode",m,this),Object(C.a)(this,"contour",v,this)}return Object(D.a)(e,[{key:"setShowContour",value:function(e){this.showContour=e}},{key:"setShowDiagram",value:function(e){this.showDiagram=e}},{key:"setShowDiagramEdge",value:function(e){this.showDiagramEdge=e}},{key:"setFilterOutMode",value:function(e){this.filterOutMode=e}},{key:"setContourRadius",value:function(e){this.contour.kernelRadius=e}}]),e}(),d=Object(N.a)(h.prototype,"showContour",[g.j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),p=Object(N.a)(h.prototype,"showDiagram",[g.j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),f=Object(N.a)(h.prototype,"showDiagramEdge",[g.j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),m=Object(N.a)(h.prototype,"filterOutMode",[g.j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),v=Object(N.a)(h.prototype,"contour",[g.j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{kernelRadius:64}}}),Object(N.a)(h.prototype,"setShowContour",[i],Object.getOwnPropertyDescriptor(h.prototype,"setShowContour"),h.prototype),Object(N.a)(h.prototype,"setShowDiagram",[l],Object.getOwnPropertyDescriptor(h.prototype,"setShowDiagram"),h.prototype),Object(N.a)(h.prototype,"setShowDiagramEdge",[s],Object.getOwnPropertyDescriptor(h.prototype,"setShowDiagramEdge"),h.prototype),Object(N.a)(h.prototype,"setFilterOutMode",[c],Object.getOwnPropertyDescriptor(h.prototype,"setFilterOutMode"),h.prototype),Object(N.a)(h.prototype,"setContourRadius",[u],Object.getOwnPropertyDescriptor(h.prototype,"setContourRadius"),h.prototype),h);function R(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;console.time("search subgraph");var n={};t.nodes.forEach(function(e){n[e.label]?n[e.label]+=1:n[e.label]=1});var a=e.nodes.filter(function(e){return n[e.label]}),o=new Set(a.map(function(e){return e.index})),i=e.links.filter(function(e){return o.has(e.source.index)&&o.has(e.target.index)});console.time("dfs");var l=[],s={},c={},u=function e(r){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(c[r.label]||(c[r.label]=0),c[r.label]>=(n[r.label]||0))return!1;if(c[r.label]+=1,s[r.index]=!0,a.push(r.index),a.length===t.nodes.length)return l.push(a.slice(0)),a.pop(),c[r.label]-=1,!0;var o=!0,u=!1,h=void 0;try{for(var d,p=i[Symbol.iterator]();!(o=(d=p.next()).done);o=!0){var f=d.value;f.source.index===r.index?s[f.target.index]||e(f.target,a):f.target.index===r.index&&(s[f.source.index]||e(f.source,a))}}catch(m){u=!0,h=m}finally{try{o||null==p.return||p.return()}finally{if(u)throw h}}return a.pop(),c[r.label]-=1,!0},h=!0,d=!1,p=void 0;try{for(var f,m=a[Symbol.iterator]();!(h=(f=m.next()).done);h=!0){var v=f.value;s=[],c={},u(v,[])}}catch(P){d=!0,p=P}finally{try{h||null==m.return||m.return()}finally{if(d)throw p}}console.timeEnd("dfs");var g=l.map(function(t){return t.map(function(t){return e.nodes[t]})}),b=[],y=function(e){return e.source.label<e.target.label?"l_".concat(e.source.label,"$").concat(e.target.label):"l_".concat(e.target.label,"$").concat(e.source.label)},w=t.links.map(y),x={},S=!0,O=!1,E=void 0;try{for(var j,k=w[Symbol.iterator]();!(S=(j=k.next()).done);S=!0){var C=j.value;x[C]?x[C]+=1:x[C]=1}}catch(P){O=!0,E=P}finally{try{S||null==k.return||k.return()}finally{if(O)throw E}}return g.forEach(function(e){var n=new Set(e.map(function(e){return e.index})),a=i.filter(function(e){return n.has(e.source.index)&&n.has(e.target.index)}),o={};a.forEach(function(e){var t=y(e);o[t]=(o[t]||0)+1}),function(e,t){var r=0;for(var n in e){var a=t[n]||0;r+=Math.max(e[n]-a,0)}return r}(x,o)>t.links.length*r||b.push(e.slice())}),console.timeEnd("search subgraph"),b}var T,F,I,_,A,B,L,U,H,W=r(61),Y=r.n(W),V="http://localhost:3000/api/alg/";function X(e){return Object(j.a)({},e,{links:e.links.map(function(e){return{source:e.source.index,target:e.target.index}})})}function q(){return(q=Object(k.a)(E.a.mark(function e(t,r,n){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.time("search subgraph via server"),e.next=3,Y.a.post("".concat(V,"/search_subgraph"),{graph:X(t),subgraph:X(r),tolerance:n}).then(function(e){console.log(e.data)});case 3:return console.timeEnd("search subgraph via server"),e.abrupt("return",0);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}var G,$,J,K,Q,Z,ee,te=(T=g.b.bound,F=g.b.bound,I=g.b.bound,_=function(){function e(t){Object(P.a)(this,e),this.parent=t,Object(C.a)(this,"subgraphs",A,this),Object(C.a)(this,"searchTolerance",B,this),Object(C.a)(this,"selectedPatternId",L,this),Object(C.a)(this,"selectedPatternNodes",U,this),Object(C.a)(this,"hoveredPattern",H,this)}return Object(D.a)(e,[{key:"setSearchTolerance",value:function(e){this.searchTolerance=e}},{key:"selectPattern",value:function(e){null===e?(this.selectedPatternId=null,this.selectedPatternNodes=null):(this.selectedPatternId=e.index,this.selectedPatternNodes=new Set(e.nodes.map(function(e){return e.label})))}},{key:"setPatternHover",value:function(e){this.hoveredPattern=e}},{key:"searchedSubgraphs",get:function(){if(null!==this.selectedPatternId){var e=this.subgraphs[this.selectedPatternId],t=R({nodes:this.parent.graphData.nodes,links:this.parent.graphEdgeArrayCopy},e,this.searchTolerance);return function(e,t,r){q.apply(this,arguments)}({nodes:this.parent.graphData.nodes,links:this.parent.graphEdgeArrayCopy},e,this.searchTolerance),t}return null}},{key:"searchSubgraphNodes",get:function(){var e=[];return this.searchedSubgraphs?(this.searchedSubgraphs.forEach(function(t){t.forEach(function(t){e.push(t.index)})}),new Set(e)):null}}]),e}(),A=Object(N.a)(_.prototype,"subgraphs",[g.j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),B=Object(N.a)(_.prototype,"searchTolerance",[g.j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),L=Object(N.a)(_.prototype,"selectedPatternId",[g.j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=Object(N.a)(_.prototype,"selectedPatternNodes",[g.j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=Object(N.a)(_.prototype,"hoveredPattern",[g.j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Object(N.a)(_.prototype,"setSearchTolerance",[T],Object.getOwnPropertyDescriptor(_.prototype,"setSearchTolerance"),_.prototype),Object(N.a)(_.prototype,"selectPattern",[F],Object.getOwnPropertyDescriptor(_.prototype,"selectPattern"),_.prototype),Object(N.a)(_.prototype,"setPatternHover",[I],Object.getOwnPropertyDescriptor(_.prototype,"setPatternHover"),_.prototype),Object(N.a)(_.prototype,"searchedSubgraphs",[g.c],Object.getOwnPropertyDescriptor(_.prototype,"searchedSubgraphs"),_.prototype),Object(N.a)(_.prototype,"searchSubgraphNodes",[g.c],Object.getOwnPropertyDescriptor(_.prototype,"searchSubgraphNodes"),_.prototype),_),re={headers:{background:"#fff",borderBottom:"1px silver solid",boxShadow:"#ccc 0px 1px 5px"},list:{overflowY:"auto",maxHeight:window.innerHeight-80-400},left:{height:"100%",background:"#fff",overflowY:"auto",borderRight:"#ccc 1px solid",borderLeft:"#ccc 1px solid"},content:{display:"flex",flexWrap:"wrap"},panel:{padding:10,margin:10,boxShadow:"#ccc 0 0 10px",borderRadius:5},panelTitle:{color:"steelblue",userSelect:"none",textTransform:"uppercase"}},ne={normal:"#f4a460",highlighted:"#ff4500"};var ae=(G=g.b.bound,$=function(){function e(){Object(P.a)(this,e),Object(C.a)(this,"graphData",J,this),Object(C.a)(this,"diagramStore",K,this),Object(C.a)(this,"patternStore",Q,this),Object(C.a)(this,"detailStore",Z,this),Object(C.a)(this,"theme",ee,this),this.graphEdgeArrayCopy=[]}return Object(D.a)(e,[{key:"setData",value:function(){var e=Object(k.a)(E.a.mark(function e(t){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.graphEdgeArrayCopy=t.graph.links.map(function(e){return Object(j.a)({},e,{source:t.graph.nodes[e.source],target:t.graph.nodes[e.target]})}),this.graphData=t.graph,this.patternStore.subgraphs=t.subgs;case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"nodeColorMapper",get:function(){var e=this,t=this.detailStore.hitNodeLabels;return function(r){return t.has(r.label)?e.theme.diagramNodeStyle.highlighted:e.theme.diagramNodeStyle.normal}}}]),e}(),J=Object(N.a)($.prototype,"graphData",[g.j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=Object(N.a)($.prototype,"diagramStore",[g.j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new z(this)}}),Q=Object(N.a)($.prototype,"patternStore",[g.j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new te(this)}}),Z=Object(N.a)($.prototype,"detailStore",[g.j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new M(this)}}),ee=Object(N.a)($.prototype,"theme",[g.j],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{styles:re,diagramNodeStyle:ne}}}),Object(N.a)($.prototype,"setData",[G],Object.getOwnPropertyDescriptor($.prototype,"setData"),$.prototype),Object(N.a)($.prototype,"nodeColorMapper",[g.c],Object.getOwnPropertyDescriptor($.prototype,"nodeColorMapper"),$.prototype),$),oe=function(){return new ae},ie=y.a.createContext(null),le=function(e){var t=e.children,r=Object(S.c)(oe);return y.a.createElement(ie.Provider,{value:r},t)},se=function(){var e=y.a.useContext(ie);if(!e)throw new Error("No store provided!");return e},ce=(r(158),r(96)),ue=r(16),he=r(37),de=Object(ue.a)(function(e){var t=e.pattern,r=e.showLabel,n=e.showEdge,a=e.width,o=e.height,i=e.viewPort,l=e.background,s=e.colorMapping,c=e.onClickNode,u=e.brushable,h=e.radius,d=void 0===h?5:h,p=y.a.createElement("g",null),f={cursor:c?"pointer":"default"},m=y.a.useCallback(function(e){c&&c(e)},[c]),v=y.a.useRef(null);if(y.a.useEffect(function(){u&&he.g(v.current).append("g").attr("class","brush").call(he.a().extent([[-100,100],[-100,100]]).on("brush",function(){console.log(he.b.selection)}))}),t){var g=void 0===s?"orange":s,b=function(e){return"string"===typeof g?g:g(e)},w=t.nodes.map(function(e){return y.a.createElement("circle",{style:f,key:"n".concat(e.index),cx:e.x,cy:e.y,r:d,fill:b(e),onClick:function(){return m(e)}})}),x=y.a.createElement("g",{className:"nodes"},w),S=null;if(r){var O=t.nodes.map(function(e){return y.a.createElement("text",{key:"l".concat(e.index),x:e.x,y:e.y},e.label)});S=y.a.createElement("g",{className:"labels"},O)}var E=null;if(n){var j=t.links.map(function(e){var t=e.source,r=e.target;return y.a.createElement("line",{key:"e".concat(e.index),x1:t.x,y1:t.y,x2:r.x,y2:r.y,strokeWidth:.3,stroke:"darkgrey",strokeOpacity:.9})});E=y.a.createElement("g",{className:"edges"},j)}p=y.a.createElement("g",{className:"content"},E,x,S)}var k=i.join(" "),C={display:"inline-block",margin:"0 auto",width:"".concat(a,"px"),height:"".concat(o,"px")};return void 0!==l&&(C.background=l),y.a.createElement("svg",{style:C,viewBox:k,ref:v},p)}),pe=Object(ue.a)(function(e){var t=se(),r=e.patterns,n=e.width,a=void 0===n?100:n,o=e.height,i=void 0===o?100:o,l=b.useCallback(function(e){var r=t.patternStore.selectedPatternNodes;if(!r)return!1;for(var n=new Set(e.nodes.map(function(e){return e.label})),a=0,o=0,i=Array.from(r);o<i.length;o++){var l=i[o];n.has(l)&&++a}return a===r.size&&a===n.size},[t.patternStore.selectedPatternNodes]),s=b.createElement("div",null);if(r){var c=Math.min(a,i),u=c,h={display:"inline-block",border:"#5a5a5a 1px solid",margin:5,padding:1},d=function(){t.patternStore.setPatternHover(null)},p=r.map(function(e,r){var n=h;return t.patternStore.selectedPatternNodes&&l(e)&&(n={display:"inline-block",background:"#a0d8ef",border:"#5a5a5a 1px solid",margin:5,padding:1}),e.index===t.patternStore.hoveredPattern&&(n=Object(j.a)({},n,{border:"#96514d 1px solid",boxShadow:"#ccc 0px 0px 3px"})),b.createElement("div",{key:e.index,style:n,onClick:function(){return function(e){l(e)?t.patternStore.selectPattern(null):t.patternStore.selectPattern(e)}(e)},onMouseEnter:function(){return function(e){t.patternStore.setPatternHover(e.index)}(e)},onMouseLeave:d},b.createElement(de,{pattern:e,showLabel:!0,showEdge:!0,width:c,height:u,viewPort:e.viewBox}))});s=b.createElement("div",null,p)}return b.createElement("div",null,s)});function fe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=1/0,n=1/0,a=-1/0,o=-1/0;return e.nodes.forEach(function(e){r=Math.min(r,e.x),n=Math.min(n,e.y),a=Math.max(a,e.x),o=Math.max(o,e.y)}),[r-t,n-t,a-r+2*t,o-n+2*t]}var me=Object(ue.a)(function(e){var t=se(),r=e.patterns,n=e.width,a=void 0===n?400:n,o=e.height,i=void 0===o?400:o,l={border:"silver 1px solid",background:"white"},s=function(e){var r=t.patternStore.selectedPatternNodes;if(!r)return!1;for(var n=new Set(e.nodes.map(function(e){return e.label})),a=0,o=0,i=Array.from(r);o<i.length;o++){var l=i[o];n.has(l)&&++a}return a===r.size&&a===n.size};if(r){var c=r.map(function(e){return{x:e.coords[0],y:e.coords[1]}}),u=fe({nodes:c},.5),h=function(){t.patternStore.setPatternHover(null)},d=c.map(function(e,n){var a=s(r[n]);return y.a.createElement("circle",{key:e.index,cx:e.x,cy:e.y,r:.15,stroke:"#96514d",strokeWidth:n===t.patternStore.hoveredPattern?.05:0,fill:a?"#0094c8":"#d9a62e",onMouseEnter:function(){return e=r[n],void t.patternStore.setPatternHover(e.index);var e},onMouseLeave:h,onClick:function(){return e=r[n],void(s(e)?t.patternStore.selectPattern(null):t.patternStore.selectPattern(e));var e}})});return y.a.createElement("svg",{style:l,width:a,height:i,viewBox:u.join(" ")},y.a.createElement("g",null,d))}return y.a.createElement("svg",{style:l})}),ve=(r(106),r(45)),ge=(r(161),r(130)),be=(r(108),r(52)),ye=r(97),we=(r(247),r(94)),xe=r(124);function Se(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;e.nodes=xe.map(e.features,function(e,t){return{index:t,label:e}}),e.links=e.edges.map(function(e,t){return{index:t,source:e[0],target:e[1]}});for(var r=he.f(e.nodes).force("charge",he.e()).force("link",he.d(e.links)).force("center",he.c()).stop(),n=0;n<t;++n)r.tick();return e}var Oe=r(34),Ee=r.n(Oe);function je(e,t){return function(e,t){if(t=t||2,0===e.length)return[];if(1===e.length)return[.5,.5];e=Ee.a.mul(e,100);for(var r=Ee.a.mul(Ee.a.pow(e,2),-.5),n=function(e){return Ee.a.div(Ee.a.add.apply(null,e),e.length)},a=n(r),o=n(Ee.a.transpose(r)),i=n(a),l=0;l<r.length;++l)for(var s=0;s<r[0].length;++s)r[l][s]+=i-a[l]-o[s];var c=Ee.a.svd(r),u=Ee.a.sqrt(c.S);return c.U.map(function(e){return Ee.a.mul(e,u).splice(0,t)})}(function(e){for(var t,r,n=[],a=0;a<e.length;++a)n[a]=[];for(var o=0;o<e.length;++o){n[o][o]=0;for(var i=o+1;i<e.length;++i)n[o][i]=(t=e[o],r=e[i],Math.sqrt(function(e,t){for(var r=0,n=0;n<e.length;++n)r+=(e[n]-t[n])*(e[n]-t[n]);return r}(t,r))),n[i][o]=n[o][i]}return n}(e),t)}function ke(e){var t=je(e.features),r=e.subgs.map(Se),n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=1/0,n=1/0,a=-1/0,o=-1/0;return e.forEach(function(e){e.nodes.forEach(function(e){r=Math.min(r,e.x),n=Math.min(n,e.y),a=Math.max(a,e.x),o=Math.max(o,e.y)})}),[r-t,n-t,a-r+2*t,o-n+2*t]}(r);return r.forEach(function(r,a){r.index=a,r.viewBox=n,r.feature=e.features[a],r.coords=t[a]}),e}var Ce="http://www.apoet.fun:9999/api";function Pe(){return(Pe=Object(k.a)(E.a.mark(function e(){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.a.get("".concat(Ce,"/listGraphs")).then(function(e){return e.data});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function De(){return(De=Object(k.a)(E.a.mark(function e(t){return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.a.get("".concat(Ce,"/graph/").concat(t)).then(function(e){return e.data});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Ne=we.a.Option,Me=Object(ue.a)(function(){var e=se(),t=y.a.useState([]),r=Object(ye.a)(t,2),n=r[0],a=r[1],o=y.a.useState(),i=Object(ye.a)(o,2),l=i[0],s=i[1];y.a.useEffect(function(){(function(){return Pe.apply(this,arguments)})().then(function(e){a(e),e.length>0&&s(e[0])})},[]);var c=y.a.useCallback(function(){(function(e){return De.apply(this,arguments)})(l).then(function(t){e.setData(ke(t))})},[l,e.setData]),u=n.map(function(e){return y.a.createElement(Ne,{key:e,value:e},e)});return y.a.createElement(ve.a,{gutter:16},y.a.createElement(be.a,{span:3},y.a.createElement(we.a,{style:{width:180},value:l,onSelect:s},u)),y.a.createElement(be.a,{span:1},y.a.createElement(ge.a,{type:"primary",onClick:c},"Load")))}),ze=(r(248),r(95)),Re=(r(225),r(63)),Te=(r(227),r(76)),Fe={switch:{width:60},radio:{display:"block",height:"30px",lineHeight:"30px"}},Ie=Object(ue.a)(function(){var e=se(),t=e.diagramStore,r=e.patternStore,n=e.graphData;return b.createElement("div",null,b.createElement(ve.a,null,b.createElement("h2",null,"Graph info:"),n?b.createElement("div",null,"|V| = ",n.nodes.length," |E| = ",n.links.length):null),b.createElement("hr",null),b.createElement(ve.a,null,b.createElement(be.a,{span:16},b.createElement("label",null,"Diagram: ")),b.createElement(Te.a,{style:Fe.switch,checked:t.showDiagram,checkedChildren:"Show",onChange:t.setShowDiagram})),b.createElement(ve.a,null,b.createElement(be.a,{span:16},b.createElement("label",null,"Contour: ")),b.createElement(Te.a,{style:Fe.switch,checked:t.showContour,checkedChildren:"Show",onChange:t.setShowContour})),b.createElement(ve.a,null,b.createElement(be.a,{span:16},b.createElement("label",null,"Edges in diagram: ")),b.createElement(Te.a,{style:Fe.switch,checked:t.showDiagramEdge,checkedChildren:"Show",onChange:t.setShowDiagramEdge})),b.createElement(ve.a,null,b.createElement("h3",null,"Filter mode:"),b.createElement(Re.a.Group,{onChange:function(e){t.setFilterOutMode(e.target.value)},value:t.filterOutMode},b.createElement(Re.a,{style:Fe.radio,value:0},"No filter"),b.createElement(Re.a,{style:Fe.radio,value:1},"Filter by common nodes"),b.createElement(Re.a,{style:Fe.radio,value:2},"Filter by pattern"))),b.createElement("hr",null),b.createElement("h3",null,"Parameters:"),b.createElement("label",null," Contour radius: "),b.createElement(ze.a,{min:0,max:500,value:t.contour.kernelRadius,onChange:function(e){t.setContourRadius(e)}}),b.createElement("label",null," Search tolerance: "),b.createElement(ze.a,{min:0,max:1,step:.05,value:r.searchTolerance,onChange:function(e){r.setSearchTolerance(e)}}))}),_e=Object(ue.a)(function(e){var t=e.pattern,r=e.showLabel,n=e.showEdge,a=e.width,o=e.height,i=e.viewPort,l=e.background,s=e.colorMapping,c=e.onClickNode,u=e.radius,h=void 0===u?5:u,d=y.a.createElement("g",null),p={cursor:c?"pointer":"default"},f=y.a.useCallback(function(e){c&&c(e)},[c]),m=y.a.useRef(null);if(t){var v=void 0===s?"orange":s,g=function(e){return"string"===typeof v?v:v(e)},b=t.nodes.map(function(e){return y.a.createElement("circle",{style:p,key:"n".concat(e.index),cx:e.x,cy:e.y,r:h,fill:g(e),onClick:function(){return f(e)}},y.a.createElement("title",null,e.label))}),w=y.a.createElement("g",{className:"nodes"},b),x=null;if(r){var S=t.nodes.map(function(e){return y.a.createElement("text",{key:"l".concat(e.index),x:e.x,y:e.y},e.label)});x=y.a.createElement("g",{className:"labels"},S)}var O=null;if(n){var E=t.links.map(function(e){var t=e.source,r=e.target;return y.a.createElement("line",{key:"e".concat(e.index),x1:t.x,y1:t.y,x2:r.x,y2:r.y,strokeWidth:.3,stroke:"darkgrey",strokeOpacity:.9})});O=y.a.createElement("g",{className:"edges"},E)}d=y.a.createElement("g",{className:"content"},O,w,x)}var j=i.join(" "),k={display:"inline-block",margin:"0 auto",width:"".concat(a,"px"),height:"".concat(o,"px")};return void 0!==l&&(k.background=l),y.a.createElement("svg",{style:k,viewBox:j,ref:m},d)}),Ae=Object(ue.a)(function(e){var t=se(),r=e.width,n=void 0===r?500:r,a=e.height,o=void 0===a?500:a,i=t.nodeColorMapper,l=y.a.useCallback(function(e){t.detailStore.selectedNodes===e?t.detailStore.setSelectedNodes([]):t.detailStore.setSelectedNodes([e])},[t]);return y.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},y.a.createElement("label",null,"Similar subgraphs: ",t.detailStore.hits),t.detailStore.pattern?y.a.createElement(_e,{pattern:t.detailStore.pattern,showLabel:!0,showEdge:!0,width:n,height:o,colorMapping:i,onClickNode:l,viewPort:t.detailStore.pattern.viewBox}):y.a.createElement("svg",{width:n,height:o}))}),Be=r(131),Le=r(129),Ue=r(132),He=r(9);var We=new He.n({vertexShader:"\nvarying vec3 offxy_intz;\n\nvoid main() {\n    offxy_intz = vec3(2.0 * (uv - vec2(.5, .5)), position.z);\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position.xy, 1.0, 1.0);\n}\n",fragmentShader:"\nprecision highp float;\n\nvarying vec3 offxy_intz;\n\nvoid main() {\n    vec2 off = offxy_intz.xy;\n\n    float intensity = offxy_intz.z;\n\n    float decay = (1.0 - smoothstep(0.0, 1.0, length(off)));\n\n    // gl_FragColor = vec4(0.0);\n    gl_FragColor = vec4(intensity * decay);\n}\n",blending:He.c,blendSrc:He.i,blendDst:He.i});function Ye(e,t){var r=function(e,t){var r=new He.a,n=[],a=[],o=[];return e.forEach(function(e,r){var i=4*r,l=e.x,s=e.y,c=e.intensity,u=void 0===c?1:c;n.push(l-t,s-t,u),n.push(l-t,s+t,u),n.push(l+t,s+t,u),n.push(l+t,s-t,u),a.push(0,1),a.push(0,0),a.push(1,0),a.push(1,1),o.push(i+1,i+0,i+2),o.push(i+0,i+3,i+2)}),r.setIndex(o),r.addAttribute("position",new He.d(n,3)),r.addAttribute("uv",new He.d(a,2)),r}(e,t);return r.computeBoundingBox(),new He.f(r,We)}function Ve(e,t,r){var n=Ye(e,t),a=function(e){if(e[2]>e[3]){var t=e[2]-e[3];return[e[0],e[0]+e[2],e[1]+e[3]+.5*t,e[1]-.5*t]}var r=e[3]-e[2];return[e[0]-.5*r,e[0]+e[2]+.5*r,e[1]+e[3],e[1]]}(r),o=new He.j(a[0],a[1],a[2],a[3],1,10);return o.position.set(0,0,2),{mesh:n,camera:o}}var Xe=function(){function e(t,r,n){Object(P.a)(this,e),this.sizeX=t,this.sizeY=r,this.renderer=n,this.rt=void 0,this.init()}return Object(D.a)(e,[{key:"calculate",value:function(e){var t=e.mesh,r=e.camera;this.renderer.setRenderTarget(this.rt),this.renderer.setClearColor("#000000",0);var n=new He.m;n.add(t),n.add(r),this.renderer.clearTarget(this.rt,!0,!1,!1),this.renderer.render(n,r,this.rt,!1)}},{key:"getRenderTarget",value:function(){return this.rt}},{key:"init",value:function(){return this.renderer.extensions.get("OES_texture_float")?0===this.renderer.capabilities.maxVertexTextures?(console.error("No support for vertex shader textures."),!1):(this.rt=new He.o(this.sizeX,this.sizeY,{wrapS:He.b,wrapT:He.b,minFilter:He.h,magFilter:He.h,format:He.l,type:He.e,stencilBuffer:!1,depthBuffer:!1}),null):(console.error("No OES_texture_float support for float textures."),!1)}}]),e}(),qe=function(){function e(t){Object(P.a)(this,e),this.renderer=t,this.hCalc=void 0,this.minInterval=.01,this.buffer=new Float32Array(e.SampleSize*e.SampleSize*4),this.init()}return Object(D.a)(e,[{key:"calculate",value:function(t,r){this.hCalc.calculate(t);var n=e.SampleSize;return this.renderer.readRenderTargetPixels(this.hCalc.getRenderTarget(),0,0,n,n,this.buffer),this.pickStops(r)}},{key:"calculateMax",value:function(t){this.hCalc.calculate(t);var r=e.SampleSize;return this.renderer.readRenderTargetPixels(this.hCalc.getRenderTarget(),0,0,r,r,this.buffer),this.maxVal()}},{key:"maxVal",value:function(){var e=this.buffer.filter(function(e,t){return e>=.5&&t%4===0});if(e.length>0){var t=this.minInterval;return e.forEach(function(e){return t=Math.max(t,e)}),t}return this.minInterval}},{key:"pickStops",value:function(e){var t=e.map(function(){return 1}),r=this.buffer.filter(function(e,t){return e>=.5&&t%4===0});if(r.length>0){var n=r.length;r.sort(function(e,t){return e-t});var a=Math.max(1,r[n-1]);t=e.map(function(e,t){var o=Math.round(e*n);return o>=0&&o<n?r[o]:a})}for(var o=1;o<e.length;++o)t[o]=Math.max(t[o],t[o-1]+this.minInterval);return t}},{key:"init",value:function(){var t=e.SampleSize;return this.hCalc=new Xe(t,t,this.renderer),null}}]),e}();qe.SampleSize=64;var Ge="\nvarying vec2 vUv;\n\nvoid main() {\n    vUv = vec2(uv.x, 1.0 - uv.y);\n\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",$e=function(){function e(t,r,n){Object(P.a)(this,e),this.sizeX=t,this.sizeY=r,this.renderer=n,this.heightmapCalculator=void 0,this.NSTOPS=7,this.stopCalculator=void 0,this.stops=[0,0,0,0,0],this.rt=void 0,this.tmpRt=void 0,this.tmpMesh=void 0,this.mesh=void 0,this.camera=void 0,this.init()}return Object(D.a)(e,[{key:"draw",value:function(e,t,r){var n=new He.m;n.add(this.mesh),this.camera=new He.j(-1,1,1,-1,1,10),this.camera.position.set(0,0,2),n.add(this.camera);var a=Ve(e,r.kernelRadius,t);if(this.stops=this.stopCalculator.calculate(a,r.levels.map(function(e){return e.frac})),this.renderer.setClearColor("#000000",0),this.renderer.clearTarget(this.rt,!0,!1,!1),this.renderer.autoClear=!1,this.renderer.setRenderTarget(this.tmpRt),this.renderer.clearColor(),e.length>0){var o=Ve(e,r.kernelRadius,t);this.heightmapCalculator.calculate(o);var i=this.mesh.material;i.uniforms.hmap.value=this.heightmapCalculator.getRenderTarget().texture,i.uniforms.bmap.value=this.tmpRt.texture;for(var l=0;l<this.NSTOPS;++l)i.uniforms["contour".concat(l)].value=r.levels[l].color,i.uniforms["stops".concat(l)].value=this.stops[l];this.renderer.setRenderTarget(this.rt),this.renderer.autoClear=!1,this.renderer.render(n,this.camera,this.rt,!1);var s=new He.m;s.add(this.tmpMesh);var c=new He.j(-1,1,1,-1,1,10);c.position.set(0,0,2),s.add(this.tmpMesh),s.add(c),this.renderer.render(s,c,this.tmpRt,!0)}}},{key:"getRenderTarget",value:function(){return this.tmpRt}},{key:"init",value:function(){this.rt=new He.o(this.sizeX,this.sizeY),this.tmpRt=new He.o(this.sizeX,this.sizeY),this.renderer.clearTarget(this.rt,!0,!0,!0);for(var e=[],t=0;t<this.NSTOPS;++t)e.push("uniform vec4 contour".concat(t,";")),e.push("uniform float stops".concat(t,";"));for(var r=[],n=this.NSTOPS-1;n>0;--n)r.push("if (val >= stops".concat(n,") return contour").concat(n,";"));for(var a="\n        vec4 getColor(float val) {\n            ".concat(r.join("\n"),"\n            else {\n                return vec4(1.0, 1.0, 1.0, 1.0);\n            }\n        }\n        "),o="\n        precision highp float;\n        ".concat(e.join("\n"),"\n        ").concat(a,"\n        ").concat("\nprecision highp float;\n\nvarying vec2 vUv;\n\nuniform sampler2D hmap;\n\nuniform sampler2D bmap;\n\nvoid main() {\n    float val = texture2D(hmap, vUv).x;\n\n    vec4 oriColor = texture2D(bmap, vec2(vUv.x, 1.0 - vUv.y));\n\n    vec4 col = vec4(.0);\n\n    if (val >= .0) {\n        // col = mix(vec4(.0), contour, val / maxval);\n        col = getColor(val);\n    }\n\n    gl_FragColor = oriColor + col;\n}\n","\n        "),i={hmap:{value:1},bmap:{value:this.tmpRt.texture}},l=0;l<this.NSTOPS;++l)i["contour".concat(l)]={value:[0,0,0,0]},i["stops".concat(l)]={value:1};var s=new He.k(2,2);this.mesh=new He.f(s,new He.n({vertexShader:Ge,fragmentShader:o,uniforms:i}));var c={tex:{value:this.rt.texture}};this.tmpMesh=new He.f(s,new He.n({vertexShader:Ge,fragmentShader:"\nprecision highp float;\n\nvarying vec2 vUv;\n\nuniform sampler2D tex;\n\nvoid main() {\n    gl_FragColor = texture2D(tex, vec2(vUv.x, 1.0 - vUv.y));\n}\n",uniforms:c})),this.heightmapCalculator=new Xe(this.sizeX,this.sizeY,this.renderer),this.stopCalculator=new qe(this.renderer)}}]),e}(),Je=function(e){function t(){var e,r;Object(P.a)(this,t);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(r=Object(Be.a)(this,(e=Object(Le.a)(t)).call.apply(e,[this].concat(a)))).refs=void 0,r.scene=void 0,r.camera=void 0,r.mesh=void 0,r.renderer=void 0,r.frameId=void 0,r.blurer=void 0,r}return Object(Ue.a)(t,e),Object(D.a)(t,[{key:"componentDidMount",value:function(){this.setupRenderer(),this.setupCalculator(),this.setupScene(),this.updateScene(this.props),this.updateFrame()}},{key:"setupScene",value:function(){this.scene=new He.m,this.camera=new He.j(-1,1,1,-1,1,10),this.camera.position.set(0,0,2),this.scene.add(this.camera);var e=new He.k(2,2),t=new He.g({map:this.blurer.getRenderTarget().texture});this.mesh=new He.f(e,t),this.scene.add(this.mesh)}},{key:"componentWillUnmount",value:function(){void 0!==this.frameId&&(cancelAnimationFrame(this.frameId),this.renderer&&this.scene&&this.camera&&this.renderer.render(this.scene,this.camera)),this.mesh&&(this.scene&&this.scene.remove(this.mesh),this.mesh.geometry.dispose()),this.renderer.dispose()}},{key:"componentWillUpdate",value:function(e,t){this.updateScene(e)}},{key:"setupRenderer",value:function(){this.scene=new He.m,this.renderer=new He.p({canvas:this.refs.viewCanvas}),this.renderer.setClearColor("#FFFFFF",1),this.renderer.clear(),this.renderer.setClearColor("#000000",0)}},{key:"setupCalculator",value:function(){this.blurer=new $e(this.props.width,this.props.height,this.renderer)}},{key:"updateFrame",value:function(){this.frameId=requestAnimationFrame(this.updateFrame.bind(this)),this.renderer.setRenderTarget(void 0),this.renderer.setClearColor("#ffffff",1),this.renderer.clear(),this.renderer&&this.scene&&this.props.data.length>0&&this.renderer.render(this.scene,this.camera)}},{key:"render",value:function(){var e=this.props,t=e.width,r=e.height;return b.createElement("canvas",{style:{},width:t,height:r,onWheel:function(e){console.log(e)},ref:"viewCanvas"})}},{key:"updateScene",value:function(e){var t=e.data,r=e.vbox,n=e.param;void 0!==t&&0!==t.length&&this.blurer.draw(t,r,n)}}]),t}(b.Component),Ke=[{frac:0,color:[.57,.8,.93,.5]},{frac:.25,color:[.57,.8,.93,.75]},{frac:.4,color:[.33,.66,1,.75]},{frac:.55,color:[.22,.55,1,.8]},{frac:.7,color:[.17,.44,.78,.85]},{frac:.95,color:[.14,.29,.61,.85]},{frac:.99,color:[.12,.24,.47,.9]}],Qe=Object(ue.a)(function(e){var t=se(),r=e.width,n=e.height,a=t.graphData,o=[],i={levels:Ke,kernelRadius:t.diagramStore.contour.kernelRadius};if(a){a.nodes.forEach(function(e){t.patternStore.selectedPatternNodes&&!t.patternStore.selectedPatternNodes.has(e.label)||o.push({x:e.x,y:e.y,intensity:1})});var l=fe(t.graphData);return y.a.createElement(Je,{data:o,param:i,width:r,height:n,vbox:l})}return y.a.createElement(Je,{data:[],param:i,width:r,height:n,vbox:[0,1,0,1]})}),Ze=Object(ue.a)(function(e){var t=se(),r=e.width,n=void 0===r?800:r,a=e.height,o=void 0===a?800:a,i=t.nodeColorMapper,l={width:n,height:o,overflow:"visible",position:"absolute",top:0,left:0},s={width:n,height:o,overflow:"visible",position:"absolute",top:0,left:0,zIndex:999},c={height:o,width:n,position:"relative"},u={nodes:[],links:[]};if(t.graphData&&(u.nodes=t.graphData.nodes,u.links=t.graphEdgeArrayCopy,t.diagramStore.filterOutMode&&null!==t.patternStore.selectedPatternNodes))if(1===t.diagramStore.filterOutMode&&null!==t.patternStore.selectedPatternNodes){var h=t.patternStore.selectedPatternNodes;u.nodes=u.nodes.filter(function(e){return h.has(e.label)}),u.links=u.links.filter(function(e){return h.has(e.source.label)&&h.has(e.target.label)})}else if(2===t.diagramStore.filterOutMode&&null!==t.patternStore.searchSubgraphNodes){var d=t.patternStore.searchSubgraphNodes;u.nodes=u.nodes.filter(function(e){return d.has(e.index)}),u.links=u.links.filter(function(e){return d.has(e.source.index)&&d.has(e.target.index)})}return y.a.createElement("div",{style:c},y.a.createElement("div",{style:l},t.diagramStore.showContour?y.a.createElement(Qe,{width:n,height:o}):null),y.a.createElement("div",{style:s},t.diagramStore.showDiagram&&t.graphData?y.a.createElement(de,{pattern:u,showEdge:t.diagramStore.showDiagramEdge,colorMapping:i,width:n,height:o,radius:10,viewPort:fe(t.graphData)}):null))}),et=function(e){var t=e.title,r=e.children,n=e.theme.styles,a=Object(j.a)({width:"fit-content",height:"fit-content"},n.panel);return y.a.createElement("div",{style:a},y.a.createElement("h2",{style:Object(g.l)(n.panelTitle)},t),y.a.createElement("hr",{style:{color:"#fff",boxShadow:"#ccc 0 1px 5px"}}),r)},tt=ce.a.Header,rt=ce.a.Content,nt=Object(ue.a)(function(){var e=se();return y.a.createElement("div",{className:"App"},y.a.createElement(tt,{style:Object(g.l)(e.theme.styles.headers)},y.a.createElement(Me,null)),y.a.createElement(rt,{style:{display:"flex",flexWrap:"wrap",flexDirection:"column"}},y.a.createElement(et,{title:"Diagram view",theme:e.theme},y.a.createElement(Ze,{width:750,height:750})),y.a.createElement(et,{title:"Patterns",theme:e.theme},y.a.createElement("div",{style:{width:380,height:750,overflow:"auto"}},y.a.createElement(pe,{patterns:e.patternStore.subgraphs,width:90,height:90}))),y.a.createElement(et,{title:"Pattern Relations",theme:e.theme},y.a.createElement(me,{patterns:e.patternStore.subgraphs,width:350,height:350})),y.a.createElement(et,{title:"Detail",theme:e.theme},y.a.createElement(Ae,{width:350,height:280})),y.a.createElement(et,{title:"Settings",theme:e.theme},y.a.createElement("div",{style:{width:240}},y.a.createElement(Ie,null)))))}),at=function(){return y.a.createElement("div",{className:"App"},y.a.createElement(le,null,y.a.createElement(nt,null)))};r(245),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));Object(g.d)({enforceActions:"observed"}),x.a.render(y.a.createElement(at,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[135,1,2]]]);
//# sourceMappingURL=main.25b55979.chunk.js.map